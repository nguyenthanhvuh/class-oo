\documentclass[10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[top=1in,bottom=1in,left=1in,right=1in]{geometry}
\usepackage{amsmath,amssymb}
\usepackage{booktabs}
\usepackage{hyperref}

\usepackage{xcolor}
\definecolor{dkgreen}{rgb}{0,0.5,0}
\definecolor{dkred}{rgb}{0.5,0,0}
\definecolor{dkgray}{rgb}{0.3,0.3,0.3}

\usepackage{listings}
\lstset{basicstyle=\sffamily\small,
  language=C,
  keywordstyle=\color{blue},
  ndkeywordstyle=\color{red},
  commentstyle=\color{dkgreen},
  stringstyle=\color{dkred},
  numbers=left,
  numberstyle=\ttfamily\footnotesize\color{dkgray},
  stepnumber=1,
  numbersep=8pt,
  backgroundcolor=\color{white},
  tabsize=2,
  showspaces=false,
  showstringspaces=false,
  emph={try,catch}, emphstyle=\color{red}\bfseries,
  breaklines,
  breakatwhitespace,
  mathescape,
  literate={"}{{\ttfamily"}}1
  {<-}{$\leftarrow$}2
  {!=}{$\neq$}1,
  columns=flexible,
  morekeywords={then,end,do},
}
\usepackage{etoolbox}
\newtoggle{usesol}
\settoggle{usesol}{false} % not sol version
\newcommand{\sol}[1]{\iftoggle{usesol}{\textbf{Sol:} #1}{}}
\newcommand{\notsol}[1]{\nottoggle{usesol}{#1}{}}
\newcommand{\solite}[2]{\iftoggle{usesol}{#1}{#2}}
\newcommand{\classname}{SWE 419--Fall'22}

\author{Your Name:}
\date{12/9/2022}
\title{\classname{}: Final Exam}

\begin{document}
\maketitle
\section*{Read carefully these instructions}

\begin{enumerate}
\item This is an open-book exam. This means that you can access course materials in the book/lecture notes/videos.  

\item It is a violation of the honor code to communicate, discuss, or share the contents of this exam with any other person (except the instructor or TA) about this exam.

\item You must type all solutions.  You can use plain text format or markdown.  If you use something else such as Word or LaTeX, you need to export to PDF and submit the PDF.  \textbf{Do Not} submit any code (.java) file.   if you need to change the code, put the modified code directly in your submission.  

\item You need to submit on Blackboard by the deadline. If, for any reason, you have a problem submitting to BB,  submit your final on Piazza in a private post.  Your post should also explain your problem.

\item In the exam, whenever there is a mentioning of a java file (e.g., \href{https://nguyenthanhvuh.github.io/class-oo/files/Queue.java}{Queue.java}), then you can click on it to access the file.  

\item The last two questions of the exam are optional and do not affect the grade of the final.  They help me determine grade for group functioning and to help me improve the class. If you have done them last Friday, you do not need to do them again. Otherwise, I would appreciate your feedback.
  
\end{enumerate}


\begin{center}
  \begin{tabular}{lcc}
    \toprule
    Section		&	Points	&	Score \\
    \midrule
    Question 1	&	 25	& \\
    Question 2	&	 25	& \\
    Question 3 	&	 25	& \\
    Question 4 	&	 25	& \\
    Question 5 	&	 0	& \\
    Question 6 	&	 0	& \\
    \midrule
    Total		&	100	& \\
    \bottomrule
  \end{tabular}
\end{center}

\newpage
\section{Question 1}
Consider \href{https://nguyenthanhvuh.github.io/class-oo/files/Queue.java}{Queue.java}.



\begin{enumerate}
\item For \texttt{enQueue}, write (i) a partial contract and (ii) a total contract.  For each part, if you need to change the code for the contract, do so and explain what you did.

\sol{\textbf{Partial contract:}  has a precondition/require that \texttt{e} is a valid element (non-null), postcondition/effect is straight forward, e.g., add \textbf{e} to top of stack. 
\textbf{Total contract:} no precondition/requirement, effects/postcondition: straightforward  but also raise exception when \texttt{e} is invalid.  Would need to change the code to check that \texttt{e} is non-null and raise exception if it is.

\textbf{Things to check}: make sure the contract is written in general that every stack implementation would have.  More specifically, if it talks about this specific implementation, it is not a good contract. Can take of some points}

\item Write the rep invs for this class.  Explain what they are. 

\sol{things like elements cannot be null,  0 $\le$ size $<$ elements.length(), for i < size, elements[i] != null.

\textbf{Things to check}: off-by-1 error, e.g., $\le x$ instead of $< x$, is probably OK here, the main idea acounts.}

\item Write a reasonable \texttt{toString()} implementation. Explain what you did

\item
Consider a new method, \texttt{deQueueAll()}, which does exactly  what the name suggests. Write a reasonable contract for this method and then implement it.  Be sure to follow Bloch's advice with respect to generics. 
Explain what you did

\item
Rewrite the \texttt{deQueue()} method for an immutable version of this class. Explain what you did

\item
Write a reasonable implementation of \texttt{clone()}. Explain what you did. 

\item Explain the differences between rep invariants, loop invariants, and contract/specifications. Use the answers you provide above to demonstrate the differences.
\end{enumerate}
\newpage
\section{Question 2}

Consider Bloch's final version of his Chooser example, namely  \href{https://nguyenthanhvuh.github.io/class-oo/files/GenericChooser.java}{GenericChooser.java}.


\begin{enumerate}
\item
What would be good rep invariants for this class?  Explain each. %You may want to argue that the client \ %If so, explain exactly what you are doing and why.
\item
Supply suitable contracts for the constructor and the {\tt choose()} method
and recode if necessary.
The contracts should be consistent with your answer to the previous question.
Explain exactly what you are doing and why.
\item
Argue that the {\tt choose()} method, as documented and possibly updated
in your previous answers, is correct.  
You don't have to be especially formal, but you do have
to ask (and answer) the right questions.  
\end{enumerate}

\newpage
\section{Question 3}

Consider \href{https://nguyenthanhvuh.github.io/class-oo/files/StackInClass.java}{StackInClass.java}.
Note of the {\tt push()} method is a variation on Bloch's code.

\begin{enumerate}
\item
What is wrong with {\tt toString()}?  Fix it.

\item
As written, {\tt pushAll()} requires documentation that violates encapsulation.  Explain why
and then write a contract for {\tt pushAll()}.

\item
Rewrite the {\tt pop()} method for an immutable version of the {\tt Stack} class.
Keep the same instance variables. Explain what you did.

\item
Implementing the {\tt equals()} method for this class is a messy exercise, but would
	be much easier if the array was replaced by a list.  Explain why.
	Note:  You are not required to provide a implementation in your answer,
	but if you find it helpful to do so, that's fine.
\end{enumerate}

\newpage
\section{Question 4}

Consider the program below (\texttt{y} is the input). 
\begin{lstlisting}
{y $\ge$ 1}   // precondition

x := 0;
while(x < y)
  x += 2;

{x $\ge$ y} // post condition
\end{lstlisting}


\begin{enumerate}
\item Informally argue that this program satisfies the given specification (pre/post conditions).
\item Provide the steps you would need to do in Hoare logic to verify the pre and post conditions (e.g., starting from the postcondition, what do you do to get to the top and create the verification condition). You do not need to actually do these steps, instead just summarize and give them.
  
\item Give 3 loop invariants for the while loop in this program. For each loop invariant, informally argue why it is a loop invariant.  Do not give the trivial loop invariants \texttt{True} and equivalent ones (e.g., if you say $x = y$ is an invariant, then do not give $y = x$ as another one).
  
\item \emph{Sufficiently strong loop invariants:}  Use a sufficiently strong loop invariant to formally prove that the program is correct with respect to given specification. This loop invariant can be one of those you computed in the previous question or something new.
  \begin{itemize}
    \item Note: show all works for this step (e.g., obtain weakest preconditions, verification condition, and analyze the verification condition).
  \item Recall that if the loop invariant is strong enough, then you will be able to do the proof. In contrast, if it is not strong enough, then you cannot do the proof.
  \end{itemize}
\item \emph{Insufficiently strong loop invariants:} Use another loop invariant (could be one of those you computed previously) and show that you cannot use it to prove the program . 
  \begin{itemize}
    \item Note: show all work as the previous question (i.e., obtain wp, verification condition, and analyze the vc).
    \end{itemize}

  \item Instead of \textbf{proving} the given specifications like above, now you just want to \textbf{test} the program.
    \begin{itemize}
    \item Provide some short JUnit Theories code to test this program.
    \item What are the benefits of using JUnit Theories comparing to (i) JUnit tests and (ii) the Hoare logic proof style above?
    \end{itemize}
\end{enumerate}



\newpage
\section{Question 5}

This question helps me determine the grade for group functioning.  It does not affect the grade of this final.

\begin{enumerate}
\item Who are your group members?
\item For each group member, rate their participation in the group on the following scale:
  \begin{enumerate}
  \item Completely absent
  \item Occasionally attended, but didn't contribute reliably
  \item Regular participant; contributed reliably
  \end{enumerate}
\item If you believe you did not contribute to your group, you can try to explain why here.
\end{enumerate}



\newpage
\section{Question 6}


There is no right or wrong answer for the below questions, but they can help me improve the class. 
I might present your text verbatim (but anonymously) to next year's students when they are considering taking the course (e.g., in the first week of class) and also add your advice to the project description pages.

\begin{enumerate}
\item What were your favorite \textbf{and} least aspects of this class? Favorite topics?
\item Favorite things the professor did or didn't do?
\item What would you change for next time?
\end{enumerate}

\end{document}
