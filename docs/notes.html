<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-09-30 Fri 13:07 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>SWE 419 Notes</title>
<meta name="author" content="ThanhVu (Vu) Nguyen" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="https://dynaroars.github.io/files/org.css">
<link rel="alternative stylesheet" href="https://dynaroars.github.io/files/org-orig.css">
</head>
<body>
<div id="content" class="content">
<h1 class="title">SWE 419 Notes</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgc533cb3">1. Lecture 5 (<span class="timestamp-wrapper"><span class="timestamp">&lt;2022-09-30 Fri&gt;</span></span>)</a></li>
<li><a href="#orgf3a5e2a">2. Lecture 4 (<span class="timestamp-wrapper"><span class="timestamp">&lt;2022-09-16 Fri&gt;</span></span>)</a></li>
<li><a href="#orge1e5c54">3. Lecture 3 (<span class="timestamp-wrapper"><span class="timestamp">&lt;2022-09-09 Fri&gt;</span></span>)</a></li>
<li><a href="#org7e5d842">4. Lecture 2 (<span class="timestamp-wrapper"><span class="timestamp">&lt;2022-09-02 Fri&gt;</span></span>)</a></li>
<li><a href="#orgfe1612e">5. Lecture 1 (8/26)</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgc533cb3" class="outline-2">
<h2 id="orgc533cb3"><span class="section-number-2">1.</span> Lecture 5 (<span class="timestamp-wrapper"><span class="timestamp">&lt;2022-09-30 Fri&gt;</span></span>)</h2>
<div class="outline-text-2" id="text-1">
<p>
{y=7} x:=3 {x + y = 10)   y=7 is the weakest precondition
</p>

<p>
{y=7 AND x= 100} x:=3 {x + y = 10)
</p>


<p>
WP(x := E, Q) = Q[x/E]
WP(x:=3 , x +y = 10)  
=  x +y = 10[x/3]
=  3 +y = 10
=  y = 7
</p>

<p>
WP(z:=3, z + y &gt; 0)
= 3 +y &gt; 0
{3+y &gt;0} z := 3 {z + y &gt;0}
</p>



<p>
WP([x:=x+1; y:=y*x], y = 2*z)
= WP(x:=x+1, WP(y:=y*x, y=2*z))
= WP(x:=x+1,  y*x = 2*z)
= y*(x+1)=2*z
</p>

<p>
WP(if b then S1 else S2, Q)  =  (b =&gt; WP(S1,Q))  &amp;  (!b =&gt; WP(S2, Q))
</p>

<p>
WP(if x &gt; 0 then y := x + 2  else y := y + 1,  y &gt; x)
x &gt; 0 =&gt; WP(y:=x+2, y&gt;x)  &amp; x&lt;=0 =&gt; WP(y:=y+1, y&gt;x)
x &gt; 0 =&gt; x+2 &gt; x    &amp; x&lt;=0 =&gt; WP(y:=y+1, y&gt;x)
x &gt; 0 =&gt; True       &amp; x&lt;=0 =&gt; WP(y:=y+1, y&gt;x)
True                &amp; x&lt;=0 =&gt; WP(y:=y+1, y&gt;x)
x&lt;=0 =&gt; WP(y:=y+1, y&gt;x)
x&lt;=0 =&gt; y+1 &gt; x
</p>


<p>
// {N &gt;= 0}  #P
i = 0;
while (i &lt; N){
    i = i + 1;
}
//{i == N}  #Q
</p>


<p>
WP([i:=0; while(i&lt;N) do i:=i+1], i=N)
WP(i:=0,  WP(while(i&lt;N) do i:=i+1, i=N))
</p>

<p>
WP(while [I] b do S, Q) =  I &amp; (I &amp; b =&gt; WP(S,I) &amp; (I &amp; !b)  =&gt; Q)
let I =   <b>i&lt;=N</b>
</p>

<p>
WP(while(i&lt;N) do i:=i+1, i=N)
= i&lt;=N  &amp;  i&lt;N <code>&gt; WP( i:=i+1, i&lt;=N)  &amp; (i&lt;=N &amp; i&gt;=N)  =&gt; i=N
= i&lt;=N  &amp;  i&lt;N =&gt; i+1 &lt;</code> N    &amp;  i=N  <code>&gt; i=N
= i&lt;=N  &amp;  i&lt;N =&gt; i+1 &lt;</code> N    &amp;  True
= i&lt;=N  &amp;  i&lt;N <code>&gt; i+1 &lt;</code> N
</p>

<p>
= i&lt;=N  &amp;  i&lt;=N-1 <code>&gt; i+1 &lt;</code> N
= i&lt;=N  &amp;  i&lt;=N-1 =&gt; i =N -1
= i&lt;=N  &amp;  True
= i&lt;=N  
</p>

<p>
WP(i:=0, WP(while(i&lt;N) do i:=i+1, i=N))
WP(i:=0, i&lt;=N)
= 0&lt;=N
</p>

<p>
verification condition (vc)
P =&gt; WP([i:=0; while(i&lt;N) do i:=i+1], i=N,Q)
P <code>&gt; 0&lt;=N
N &gt;</code> 0   <code>&gt;  0 &lt;</code> N
True  (i.e.,   program is correct wrt to P and Q)
</p>

<p>
P1 <code>&gt; 0&lt;=N
N &gt;</code> 1   =&gt;  0&lt;=N   
True  (i.e.,   program is correct wrt to P and Q)
</p>

<p>
P2 =&gt; 0&lt;=N
True =&gt; 0&lt;=N
0&lt;=N
</p>



<p>
&#x2013;
let I = true
WP(while [I] b do S, Q) =  I &amp; (I &amp; b =&gt; WP(S,I) &amp; (I &amp; !b)  =&gt; Q)
WP(while(i&lt;N) do i:=i+1, i=N)
= True &amp;    True &amp; i&lt;N =&gt; WP(i:=i+1, True) &amp;    (True &amp; i&gt;=N)  =&gt; i=N
= True &amp;    True &amp; i&lt;N =&gt; True  &amp;    (True &amp; i&gt;=N)  =&gt; i=N
= (True &amp; i&lt;N) =&gt; True    &amp;     (i&gt;=N  =&gt; i=N)
= (i&lt;N =&gt; True)  &amp;   (i&gt;=N  =&gt; i=N)
=     i&gt;=N       &amp;   (i&gt;=N  =&gt; i=N)
</p>


<p>
WP(i:=0, i&gt;=N   &amp; (i&gt;=N  =&gt; i=N))
0&gt;=N  &amp;  (0&gt;=N  =&gt;  0=N)
</p>


<p>
VC
P =&gt; 0&gt;=N  &amp;  (0&gt;=N  =&gt;  0=N)
N&gt;=0   =&gt;  0&gt;=N  &amp;  (0&gt;=N  =&gt;  0=N)
Not simplified to True
</p>



<p>
{True} i:=i+1  {True}
</p>

<p>
Q[x/E]
True[i/i+1]
True
</p>

<p>
WP(i:=i+1,  x=10)
x=10[i/i+1]
x=10
</p>

<p>
{x=10} {i:=i+1} {x=10}
</p>



<p>
// {N &gt;= 0}   # P
i = 0;
while (i &lt; N){
    i = i + 1;
}
</p>

<p>
// {N &gt;= 0}   # P
i = 0;
while (1){
    [I]  // 
    if (!(i &lt; N)) break;
    i = i + 1;
}
</p>


<ol class="org-ol">
<li>i&lt;=N &#x2026; loop inv</li>
<li>i&gt;=0  &#x2026; loop inv</li>
</ol>
</div>


<div id="outline-container-orgfa71630" class="outline-3">
<h3 id="orgfa71630"><span class="section-number-3">1.1.</span> Repr Invariants</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>things that are true about a data structure</li>
<li>binary tree 
<ul class="org-ul">
<li>at most two children</li>
<li>all nodes except root has a parent</li>
</ul></li>

<li>BinTree
<ul class="org-ul">
<li>add(x)</li>
<li></li>
</ul></li>

<li>Set
<ul class="org-ul">
<li>Distinct</li>
</ul></li>

<li>BinarySearchTree
<ul class="org-ul">
<li></li>
</ul></li>
</ul>

<p>
ReprOK()
RepOK()
</p>
</div>
</div>
</div>

<div id="outline-container-orgf3a5e2a" class="outline-2">
<h2 id="orgf3a5e2a"><span class="section-number-2">2.</span> Lecture 4 (<span class="timestamp-wrapper"><span class="timestamp">&lt;2022-09-16 Fri&gt;</span></span>)</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org6e94594" class="outline-3">
<h3 id="org6e94594"><span class="section-number-3">2.1.</span> No class next Friday</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>will send out details later</li>
</ul>
</div>
</div>

<div id="outline-container-org6362ca7" class="outline-3">
<h3 id="org6362ca7"><span class="section-number-3">2.2.</span> Topic: Automatic Verification</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li><p>
Logic
</p>

<p>
a =&gt; b   :  !a OR b
</p>

<ul class="org-ul">
<li>there is class next Friday :   False</li>
<li>today is September 16:  True</li>

<li>x &gt; 6 and x &lt; 5  : False  (no value of x would satisfy this)</li>
<li>x &gt; 6  =&gt;  x &gt; 1   :  True</li>
<li>x &gt; 6  and  y = 3   :  False , counterxample(cex) : (x=5 , y=2)</li>
<li>x &gt; 6  <code>&gt;  y = 3   :  False,       cex  : (x=7,  y=4)
    x &lt;</code> 6  or  y = 3</li>
</ul>

<p>
satisfiable:
  f :  satisfiable   if there is some assignment to the values in f that makes f evaluate to True
</p>
<ul class="org-ul">
<li>x &lt;= 6 or y = 3  is satisfiable (e.g.,  x=4, y=4)</li>
<li>x &gt; 6  and  y = 3 is SAT (e.g.,  x =7, y=3)</li>
<li>x &gt; 6  =&gt;  x &gt; 1   is SAT (e.g.,  x=7)</li>
<li>x &gt; 6 and x &lt; 5   is UNSAT</li>
</ul>

<p>
valid (tautology):
  f : valid, if f evaluates to True for <b>every</b> assignment (f is <b>always</b> satisfiable)
</p>
<ul class="org-ul">
<li>x &gt; 6  =&gt;  x &gt; 1   is valid</li>
<li>x = x  is valid</li>
</ul>

<p>
falsification:
 f : is falsification if f elvalues to False for <b>every</b> assignment (f is <b>always</b> unsat)
</p>
<ul class="org-ul">
<li>x &gt; 6 and x &lt; 5</li>
<li>x != x</li>
<li>x = x + 1   (if x = some infinite number, then x = x + 1 would True, so assume x is finite)</li>
</ul></li>
</ul>


<p>
Implication   a =&gt; b   =  !a or b
</p>

<ul class="org-ul">
<li>f =&gt; f      =  Valid    (!f or f)</li>
<li>f =&gt; True   =  Valid    (!f or True)</li>
<li>True =&gt; f   = Not Valid  !True or f  = False or f   =  f</li>
<li>f =&gt; False   =  Not Valid       !f or False   = !f</li>
<li>False =&gt; f  =  Valid      !False or f  =  True or f  = True</li>
</ul>

<p>
Hoare Verification
</p>
<ul class="org-ul">
<li>Tony Hoare: Sir. Hoare, quick sort, verification, &#x2026;</li>
<li>automatic verification that a program S is correct with respect to precondition P and postcondition Q</li>
</ul>


<ul class="org-ul">
<li>Hoare tripple
{P}  S  {Q}
<ul class="org-ul">
<li>Precondition: P</li>
<li>Postcond :  Q</li>
<li>S :   program (statements)</li>
<li>Hoare tripple is valid: if P holds, and the successful execution of S results in Q
<ul class="org-ul">
<li>S is correct with respect to P and Q</li>
</ul></li>
</ul></li>
</ul>




<ul class="org-ul">
<li><p>
Testing   S,   P , Q
</p>

<p>
Goal: given a program S,  {P, Q},  check if S is correct wrt to P, Q
</p>
<ul class="org-ul">
<li>testing: finding some bug:  want to find if there is some (bad) input that satisfy P,  but doesn't satisy Q
<ul class="org-ul">
<li>pros: quick , test it on some finite number of inputs (K,M,B ..)</li>
<li>cons: if the test shows no bug, DOES NOT mean the program really has no bug</li>
</ul></li>

<li>verification: want to show there exist no bad input that &#x2026; 
<ul class="org-ul">
<li>pros: if verify shows no bug,  DOES mean program has bug</li>
<li>cons: runs slowly (have to consider all possible inputs)</li>
</ul></li>
</ul></li>
</ul>


<ul class="org-ul">
<li>medical (surgeries), airplan, weapons, &#x2026;</li>
<li>Hardware design (CPU)</li>
<li>Airbus:  verification to check floating errors do not occur A380 &#x2026;</li>
<li>NASA:  Rovers  (symbolic execution)</li>
<li>Facebook Newsfeed :  verification (currency), Instagram</li>
<li>Amazon AWS :  cloud computing</li>
</ul>


<p>
Examples of Hoare tripples
</p>

<ul class="org-ul">
<li>{True} x := 5  {x=5}  : Valid HT # strongest post</li>
<li>{True} x := 5  {x &gt; 4} :  Valid HT</li>
<li>{True}  x:= 5  {x=5 or x=6}  : Valid HT</li>
</ul>




<ul class="org-ul">
<li>{True}  x:= 5  {x &gt; 5}  : Invalid HT</li>

<li>{x = 1 &amp; y = 2} z:= x/y  {z &lt; 1}   : Valid</li>
<li>{x &lt; y} z:= x/y  {z &lt; 1}   :   Invalid</li>
<li>{False} x:=3 {x=8}  : Valid</li>
<li>{True} while(1){x:=8} {x=3}  : Valid (Partial correct)
<ul class="org-ul">
<li>Partial () vs Total (you have to check that the program terminates)</li>
</ul></li>

<li>Halting problem
<ul class="org-ul">
<li>given a program, is it possible to determine if it will halt or not?</li>
<li>Alan Turing
<ul class="org-ul">
<li>Break Engima (10 years of WW-II)</li>
<li>Father of Computer Science
<ul class="org-ul">
<li>Show that Halting problem is undecidable</li>
<li>Turing machine - Universal Machine</li>
<li>Turing test</li>
</ul></li>
<li>Matrix multiplication (LU-)</li>
</ul></li>
<li>Halting: Undecidable problem</li>
</ul></li>
</ul>


<p>
How to determine if Hoare Triple is valid or not?
</p>
<ul class="org-ul">
<li>Compute <b>weakest</b> preconditions (WP)</li>
<li>WP(S, Q) = P'</li>
</ul>


<ul class="org-ul">
<li>Skip:WP(skip, {x=3})=  {x=3}</li>
<li>Assignment:  
<ul class="org-ul">
<li>WP(x:=x+1, {x=3})= {x=2}
<ul class="org-ul">
<li>{x=2} x:= x+1 {x=3}</li>
</ul></li>
<li>WP(x:=x+1, {x&gt;3})= x&gt;2</li>
<li>WP(x:=1, {x=3}) = False
{False}  x:= 1 {x=3}</li>
</ul></li>
<li>Condition
<ul class="org-ul">
<li>WP(if x &gt; 0 then y := x + 2  else y:= y + 1,  {y &gt; x})
x&gt;0  and   (x  &lt; 0 -&gt; y + 1 &gt;x )</li>
</ul></li>
<li>While loop
<ul class="org-ul">
<li>loop invariant (I)
<ul class="org-ul">
<li>true when entering the loop</li>
</ul></li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #e45649;">while</span> (b){
  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">loop body</span>
}

<span style="color: #e45649;">while</span> (<span style="color: #b751b6;">True</span>){
  [I]      <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">loop invariant I is right here</span>
  <span style="color: #e45649;">if</span> (!b) <span style="color: #e45649;">break</span>
    <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">loop body</span>
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python">{N &gt;= 0} <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">precondition</span>

i := 0
<span style="color: #e45649;">while</span>(<span style="color: #b751b6;">True</span>):
  [L]
  <span style="color: #e45649;">if</span>(!(i &lt; N)):  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">i &gt;= N : break</span>
      <span style="color: #e45649;">break</span>
  i := N;
</pre>
</div>

<p>
i = i = True
N= N
i &gt;= 0
i &lt;= N   
</p>
</div>
</div>
</div>

<div id="outline-container-orge1e5c54" class="outline-2">
<h2 id="orge1e5c54"><span class="section-number-2">3.</span> Lecture 3 (<span class="timestamp-wrapper"><span class="timestamp">&lt;2022-09-09 Fri&gt;</span></span>)</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgc6cb013" class="outline-3">
<h3 id="orgc6cb013"><span class="section-number-3">3.1.</span> Go over quiz 1</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Binary_search(arrays, x)
</p>
<ul class="org-ul">
<li>precondition:
<ul class="org-ul">
<li>arrays: sorted, cannot null,</li>
</ul></li>
<li><p>
postcondition:
</p>
<ul class="org-ul">
<li>if x not in arrays: raise some exception &#x2026;</li>
<li>ow: returns index of x in array</li>
</ul>
<ul class="org-ul">
<li>Recap:
<ul class="org-ul">
<li>Specification is NOT code/implementation (it is independent of implementation)</li>
<li>Do not look at implementation to write specification (you will write specification for that implementation); write specification FIRST !</li>
<li>Raise exceptions related to the undesirable input, e.g., if you don't want null, then raise something about NullPointerException.  If you don't want bad index to array, then use something about IndexOutOfBoundException. If you don't want some type of inputs, then raise IllegalArgumentException.</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org45096dd" class="outline-3">
<h3 id="org45096dd"><span class="section-number-3">3.2.</span> Data Abstraction</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Consider <a href="./files/Poly.java">Poly.java from Liskov</a>
</p>
<ul class="org-ul">
<li>implements a class to represent <code>polynomials</code></li>
<li>10*x + 5*x^2 + 3*x^3 + 100*x^11 + 42</li>
<li>101</li>
<li>c_1*x_1^d_1 + c_2*x_2^d_2    (c_i*x_i^d_i : term,  c_i: coefficients, d_i: degree)</li>
</ul>


<ul class="org-ul">
<li>This is a <b>specific</b> implementation of Polynomials
<ul class="org-ul">
<li>uses arrays of ints to represent terms &#x2026;</li>
<li><code>deg</code> var to store degree</li>

<li>Some additional constraints for polynomials in this implementation
<ul class="org-ul">
<li>1 variable (5*x*y not allowed)</li>
<li>no negative degree</li>
<li>coefficients integers</li>
</ul></li>
</ul></li>

<li>to represent: <code>5 + 3*x^2</code> in this code
<ul class="org-ul">
<li><code>Poly(deg=2, trms</code>[5,3])=</li>
<li><code>Poly(deg=2, trms</code>[5,0,3])=</li>

<li><code>Poly(deg=2, trms</code>[5,0,3,0,0,0,0,0&#x2026;])=: not allowed in Poly implementation (last element of the array term cannot be non zero)</li>
</ul></li>
</ul>


<ul class="org-ul">
<li>1st <code>public Poly</code> contract: good (no inputs, not modifying any inputs etc)</li>
<li>2nd <code>public Poly</code> contract: also good, total contract: raise exception if n &lt; 0, otherwise return this polynomial</li>
<li><code>private Poly</code>  :  she did not forget the contract, it is assumed that it will be called by something trusted , so no need to talk about specs of these.</li>
<li><code>deg</code>:  highest degree associated with a non-zero cofficient</li>
<li><code>coeff_book()</code> vs <code>coeff()</code>  :  which is better? coeff() is better, go back to constructors:  if n &lt; 0 , it throws IAE,  but this coeff_book returns a value (implicitly allow that)</li>
</ul>
<p>
&#x2026;
</p>
<ul class="org-ul">
<li><b>abstraction method/function</b>: <code>toString</code>   -&gt; concrete (implementation) to abstract (polynomial)
<ul class="org-ul">
<li><code>Poly(deg=2, trms</code>[5,3])=   =&gt;  5+3*x</li>
<li><code>Poly(deg=2, trms</code>[5,0,3])= =&gt;  5+3x^2</li>
</ul></li>
</ul>
</div>

<div id="outline-container-orgc7db99f" class="outline-4">
<h4 id="orgc7db99f"><span class="section-number-4">3.2.1.</span> Immutable</h4>
<div class="outline-text-4" id="text-3-2-1">
<ul class="org-ul">
<li>Thread safe ;  easier for sharing; efficiency; safety;  less prone to error, easier to design</li>
<li>really good for concurrency (can do things in parallel)</li>
</ul>
</div>

<ol class="org-ol">
<li><a id="org5275e58"></a>General way to turn mutable to immutable<br />
<div class="outline-text-5" id="text-3-2-1-1">
<ul class="org-ul">
<li>If modifies contents of the data, create a new one instead and also return the newly created one</li>
<li>In other words, it would not modify the contents of the data, instead of modifying the data internally,  it returns a new data (that would have same contents as data in the the mutable version)</li>
</ul>
</div>
</li>
</ol>
</div>

<div id="outline-container-org700ead3" class="outline-4">
<h4 id="org700ead3"><span class="section-number-4">3.2.2.</span> In-class 3A</h4>
<div class="outline-text-4" id="text-3-2-2">
<pre class="example">
q = [1,2,3]
q.enQueue(4) #  q.elements = [1,2,3,4]

result = q.deQueue()
- q.elements = [2,3,4]
- result = 1

----------------

q = [1,2,3]
q' = q.enQueue_Immutable(4)  
- q.elements = [1,2,3]
- q'.elmenets = [1,2,3,4]
q = q'

q' = q.deQueue_Immutable()
result = q.getFirst()
q = q'
- q.elements = [2,3,4]
- result = 1  

</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org7e5d842" class="outline-2">
<h2 id="org7e5d842"><span class="section-number-2">4.</span> Lecture 2 (<span class="timestamp-wrapper"><span class="timestamp">&lt;2022-09-02 Fri&gt;</span></span>)</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org19549d9" class="outline-3">
<h3 id="org19549d9"><span class="section-number-3">4.1.</span> Adminstrative: Groups</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>next time:  1 submission per group</li>
</ul>
</div>
</div>

<div id="outline-container-orgf042721" class="outline-3">
<h3 id="orgf042721"><span class="section-number-3">4.2.</span> Reconsider In-class 1B (class <code>User</code>)</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #986801;">User</span> <span style="color: #6a1868;">u1</span> = <span style="color: #e45649;">new</span> <span style="color: #986801;">u1</span>(<span style="color: #50a14f;">"hello"</span>);
<span style="color: #986801;">User</span> <span style="color: #6a1868;">u2</span> = <span style="color: #e45649;">new</span> <span style="color: #986801;">User</span>(<span style="color: #b751b6;">null</span>);
u2.equals(u1); <span style="color: #9ca0a4;">//</span><span style="color: #9ca0a4;">contract:F, impl: F</span>
u1.equals(v2); <span style="color: #9ca0a4;">//</span><span style="color: #9ca0a4;">contract:F (Javadoc does not say it should raise exception), impl: exception</span>

<span style="color: #9ca0a4;">//</span><span style="color: #9ca0a4;">Q: how to fix this?</span>
<span style="color: #9ca0a4;">//</span><span style="color: #9ca0a4;">A: Check for null and return False</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge1f6286" class="outline-3">
<h3 id="orge1f6286"><span class="section-number-3">4.3.</span> Another example on how to obtain specs from documentation</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li>consider <code>remove</code> from <code>iterator</code>: <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html">https://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html</a>
<ul class="org-ul">
<li>Removes from the underlying collection the last element returned by this iterator (optional operation). This method can be called only once per call to next(). The behavior of an iterator is unspecified if the underlying collection is modified while the iteration is in progress in any way other than by calling this method.</li>
<li>Getting contracts/specs from the English description.
<ul class="org-ul">
<li>1st sentence: postcondition, specifying behavior</li>
<li>2nd:  post  or detail implementation</li>
<li>3rd:  post, side effects,  but could be a <b>precondition</b>:  statement that the collection should not be modified</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>



<div id="outline-container-org8818e9a" class="outline-3">
<h3 id="org8818e9a"><span class="section-number-3">4.4.</span> Method/Program specifications</h3>
<div class="outline-text-3" id="text-4-4">
<ul class="org-ul">
<li>Preconditions (<code>P</code>): assumptions, properties about the inputs
<ul class="org-ul">
<li>established by clients (e.g., inputs are strings, unsorted list, &#x2026;)</li>
</ul></li>

<li>Postconditions (<code>Q</code>): properties/behaviors of the method/program (usually related inputs)
<ul class="org-ul">
<li>done/established by the developers/implementations (e.g., outputs are sorted list, &#x2026;)</li>
</ul></li>

<li>When something goes wrong, who to blame?
<ul class="org-ul">
<li>If preconditions are incorrect: blame the clients</li>
<li>If preconditions are correct, and the postconditions are not correct: blame developers</li>
</ul></li>
</ul>
</div>
</div>


<div id="outline-container-orgf5cab58" class="outline-3">
<h3 id="orgf5cab58"><span class="section-number-3">4.5.</span> Weaker Preconditions and Stronger Postconditions</h3>
<div class="outline-text-3" id="text-4-5">
<ul class="org-ul">
<li>Reconsider the <code>intdiv</code> example from previous class</li>
</ul>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #986801;">int</span> <span style="color: #a626a4;">intdiv</span>(<span style="color: #986801;">int</span> <span style="color: #6a1868;">x</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">y</span>){
  <span style="color: #9ca0a4;">/*</span>
<span style="color: #9ca0a4;">  Return the integer division result x/y. </span>

<span style="color: #9ca0a4;">  preconds:</span>
<span style="color: #9ca0a4;">  - x and y are integers # (already given in type)</span>
<span style="color: #9ca0a4;">  // - y cannot be zero   # better if we can remove this</span>

<span style="color: #9ca0a4;">  postconds:</span>
<span style="color: #9ca0a4;">  - z is a number  # weak</span>
<span style="color: #9ca0a4;">  - z is an integer  # weak</span>
<span style="color: #9ca0a4;">  - z = x // y  # *strong*</span>
<span style="color: #9ca0a4;">  */</span>

  <span style="color: #e45649;">if</span> (y == 0){ <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">raise ...</span>

  }

  <span style="color: #e45649;">return</span> z
}
</pre>
</div>

<p>
If we have <code>S1 = P =&gt; Q</code> and <code>S2 = P' =&gt; Q'</code>, then 
</p>
<ul class="org-ul">
<li>S1 is better than S2 :   if P is weaker than P'</li>
<li>S1 is better than S2 :   if Q is stronger than Q'</li>
</ul>
</div>
</div>


<div id="outline-container-org17d2c33" class="outline-3">
<h3 id="org17d2c33"><span class="section-number-3">4.6.</span> Total vs Partial contract</h3>
<div class="outline-text-3" id="text-4-6">
<ul class="org-ul">
<li><b>partial</b> specification:  has a precondition</li>
<li><b>total</b> specification:  has NO precondition</li>

<li><p>
to turn a partial spec into a total spec:
</p>
<ul class="org-ul">
<li>for every precondition, remove and turn it into a new behavior in postcondition (of the form if not precondition, then do something, e.g., raising an excpetion)
<ul class="org-ul">
<li>E.g., if we have a precondition   <code>list</code> cannot be <code>null</code></li>
<li>Then we remove that precondition</li>
<li>And create the postcondition:  if list is null then raise NullPointerExeception</li>
</ul></li>
</ul>
<ul class="org-ul">
<li>in the implementation, create conditions and raise exception</li>
</ul></li>
</ul>
</div>
</div>


<div id="outline-container-org0adde54" class="outline-3">
<h3 id="org0adde54"><span class="section-number-3">4.7.</span> In-class 2</h3>
<div class="outline-text-3" id="text-4-7">
<ol class="org-ol">
<li>null : gives NPE error null pointer</li>
<li>[]   : gives IOB error (result.remove())</li>
</ol>

<p>
Happy Paths     
</p>
<ol class="org-ol">
<li>[1]  : []</li>
<li>[1,2,3] :  [2, 3]</li>
</ol>


<ul class="org-ul">
<li><p>
Partial Specs
Preconds:
</p>
<ul class="org-ul">
<li>list not null</li>
<li>list not empty (list has at least 1 elem)</li>
</ul>
<p>
Postconds:
</p>
<ul class="org-ul">
<li>return the tail of the original list</li>
</ul></li>

<li>Total Specs
Preconds: 
Postconds:
<ul class="org-ul">
<li>raise NPE if list is null</li>
<li>raise  IllegalArgumentExcdeption if list is empty</li>
<li>return the tail of the original list</li>
<li></li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #e45649;">public</span> <span style="color: #e45649;">static</span> <span style="color: #986801;">List</span>&lt;<span style="color: #986801;">Integer</span>&gt; <span style="color: #a626a4;">tail</span> (<span style="color: #986801;">List</span>&lt;<span style="color: #986801;">Integer</span>&gt; <span style="color: #6a1868;">list</span>) {

    <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">REQUIRES/PRECONDS: ???</span>
    <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">EFFECTS/POSTCONDS:  ???</span>

    <span style="color: #e45649;">if</span> (<span style="color: #986801;">list</span> <span style="color: #6a1868;">is</span> <span style="color: #b751b6;">null</span>){
        <span style="color: #986801;">raise</span> <span style="color: #6a1868;">NullPointerException</span>;
    }
    <span style="color: #e45649;">if</span> (list.size() == 0){
        <span style="color: #986801;">raise</span> <span style="color: #6a1868;">IllegalArgumentException</span>;
    }

    .....
}
</pre>
</div>

<ul class="org-ul">
<li></li>
</ul>
</div>
</div>

<div id="outline-container-org9632665" class="outline-3">
<h3 id="org9632665"><span class="section-number-3">4.8.</span> In-class 2B (<code>tail</code> implementation)</h3>
</div>
</div>



<div id="outline-container-orgfe1612e" class="outline-2">
<h2 id="orgfe1612e"><span class="section-number-2">5.</span> Lecture 1 (8/26)</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org3ba1f3c" class="outline-3">
<h3 id="org3ba1f3c"><span class="section-number-3">5.1.</span> Administrative</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li>Syllabus</li>
</ul>
</div>
</div>

<div id="outline-container-org9a38d25" class="outline-3">
<h3 id="org9a38d25"><span class="section-number-3">5.2.</span> Specification Example</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Sorting (e.g., quicksort)
</p>
<ul class="org-ul">
<li>Input: a list of integers numbers, e.g., [2,1,5,10]</li>

<li>Output:  
<ul class="org-ul">
<li><b>output is a permutation of input</b> and <b>output is in sored sorder (e.g., ascending)</b></li>
</ul></li>

<li>Alg:
<ul class="org-ul">
<li>additional requirements, e.g., (involving pivot, worst case complexity n^2, amortized nlg n)</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org2487284" class="outline-3">
<h3 id="org2487284"><span class="section-number-3">5.3.</span> Definitions</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Software Specifications (e.g., specification of a program/methoad/function)
</p>
<ul class="org-ul">
<li><b>Preconditions</b>: properties of the Inputs</li>
<li><b>Postconditions</b>: properties of the Outputs
<ul class="org-ul">
<li>Typically will have some relationships with the inputs</li>
</ul></li>
</ul>
<ul class="org-ul">
<li>Additional properties/specifications that are common for all software (desirable, but very hard to achieve)
<ul class="org-ul">
<li>secured</li>
<li>robust</li>
<li>bugs-free</li>
<li>efficiently</li>
</ul></li>

<li>Specification of a program: precondition + postcondition</li>
<li>Correctness: A program (implementation) is <b>correct</b> if it satifies the given specifications (i.e., pre/post conditions).</li>
</ul>
</div>
</div>

<div id="outline-container-orgaacb013" class="outline-3">
<h3 id="orgaacb013"><span class="section-number-3">5.4.</span> Another example</h3>
<div class="outline-text-3" id="text-5-4">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #986801;">int</span> <span style="color: #a626a4;">intdiv</span>(<span style="color: #986801;">int</span> <span style="color: #6a1868;">x</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">y</span>){
  <span style="color: #9ca0a4;">/*</span>
<span style="color: #9ca0a4;">  precond: x and y are integers, y cannot be zero</span>
<span style="color: #9ca0a4;">  postcond: z = x // y</span>
<span style="color: #9ca0a4;">  */</span>


  <span style="color: #e45649;">return</span> z
}    
</pre>
</div>
</div>
</div>



<div id="outline-container-orgab9a06b" class="outline-3">
<h3 id="orgab9a06b"><span class="section-number-3">5.5.</span> In class Exercise (User, equals)</h3>
<div class="outline-text-3" id="text-5-5">
</div>
<div id="outline-container-org1cb28c6" class="outline-4">
<h4 id="org1cb28c6"><span class="section-number-4">5.5.1.</span> Truth table for Implication (=&gt;)</h4>
<div class="outline-text-4" id="text-5-5-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">X</th>
<th scope="col" class="org-left">Y</th>
<th scope="col" class="org-left">X =&gt; Y</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">T</td>
<td class="org-left">T</td>
<td class="org-left">T</td>
</tr>

<tr>
<td class="org-left">T</td>
<td class="org-left">F</td>
<td class="org-left">F</td>
</tr>

<tr>
<td class="org-left">F</td>
<td class="org-left">T</td>
<td class="org-left">T</td>
</tr>

<tr>
<td class="org-left">F</td>
<td class="org-left">F</td>
<td class="org-left">T</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>Be careful about implication, the formula `X =&gt; Y` is only False when `X` is True but `Y` is False, in every other cases, the formula is True.</li>
</ul>
</div>
</div>


<div id="outline-container-org24bc17a" class="outline-4">
<h4 id="org24bc17a"><span class="section-number-4">5.5.2.</span> Expected properties for an implementation of `equals` (according to <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#equals(java.lang.Object)">https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#equals(java.lang.Object)</a>)</h4>
<div class="outline-text-4" id="text-5-5-2">
<ol class="org-ol">
<li>reflexive: `a == a`</li>
<li>symmetry:   `a <code>= b &lt;=&gt;  b =</code> a`</li>
<li>transitive: `a <code>= b &amp;&amp; b =</code> c  <code>&gt;  a =</code> c`</li>
</ol>


<ul class="org-ul">
<li>Examples</li>
</ul>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #986801;">User</span> <span style="color: #6a1868;">u1</span> = <span style="color: #e45649;">new</span> <span style="color: #986801;">User</span>(<span style="color: #50a14f;">"hello"</span>);
<span style="color: #986801;">User</span> <span style="color: #6a1868;">u2</span> = <span style="color: #e45649;">new</span> <span style="color: #986801;">User</span>(<span style="color: #50a14f;">"world"</span>)
User u3 = <span style="color: #e45649;">new</span> <span style="color: #986801;">User</span>(<span style="color: #50a14f;">"swe419"</span>);

<span style="color: #986801;">User</span> <span style="color: #6a1868;">u1a</span> = <span style="color: #e45649;">new</span> <span style="color: #986801;">User</span>(<span style="color: #50a14f;">"hello"</span>);
<span style="color: #986801;">User</span> <span style="color: #6a1868;">u1b</span> = <span style="color: #e45649;">new</span> <span style="color: #986801;">User</span>(<span style="color: #50a14f;">"hello"</span>);
<span style="color: #986801;">User</span> <span style="color: #6a1868;">u2a</span> = <span style="color: #e45649;">new</span> <span style="color: #986801;">User</span>(<span style="color: #50a14f;">"world"</span>);

<span style="color: #986801;">SpecialUser</span> <span style="color: #6a1868;">s1</span> = <span style="color: #e45649;">new</span> <span style="color: #986801;">SpecialUser</span>(<span style="color: #50a14f;">"hello"</span>, 1)
</pre>
</div>


<p>
For the equal implementation in In-class 1B for <code>User</code>.
</p>

<ul class="org-ul">
<li>Reflexive: OK
<ul class="org-ul">
<li>e.g., <code>u1.equals(u1): contract: T   impl: T</code></li>
</ul></li>

<li>symmetry: OK
<ul class="org-ul">
<li>e.g., <code>u1.equals(u2): False  &amp;&amp; u2.equals(u1): False    contract: F   impl: F</code></li>
<li><code>u1.equals(u1a): T  &amp;&amp; u1a.equals(u1): T  contract: T  impl: T</code></li>
</ul></li>

<li>Transitive: OK
<ul class="org-ul">
<li>e.g., <code>u1.equals(u2) &amp;&amp;  u2.equals(u3) =&gt;  u1.equals(u3) contract: T impl: T</code>,</li>
<li><code>u1.equals(u2a) &amp;&amp;  u2a.equals(u2b)  contract: T   impl: T</code></li>
</ul></li>
</ul>


<p>
Things become more complicated when involving inheritence
</p>

<ul class="org-ul">
<li>Symmetry: Not OK
<ul class="org-ul">
<li><code>u1.equals(s1)    impl:  T</code></li>
<li><code>s1.equals(u1)    impl:  F</code></li>
</ul></li>

<li><p>
A potential fix (suggested by a student)
</p>
<div class="org-src-container">
<pre class="src src-java">SpecialUser
      <span style="color: #b751b6;">@Override</span> <span style="color: #e45649;">public</span> <span style="color: #986801;">boolean</span> <span style="color: #a626a4;">equals</span> (<span style="color: #986801;">Object</span> <span style="color: #6a1868;">obj</span>) {
      <span style="color: #e45649;">if</span> (<span style="color: #4078f2; font-weight: bold;">!</span>(obj <span style="color: #e45649;">instanceof</span> SpecialUser)) <span style="color: #e45649;">return</span> <span style="color: #e45649;">super</span>.equal(obj); <span style="color: #9ca0a4;">//</span><span style="color: #9ca0a4;">obj.equals(this)</span>
       <span style="color: #e45649;">return</span> <span style="color: #e45649;">super</span>.equals(obj) &amp;&amp; ((<span style="color: #986801;">SpecialUser</span>) obj).id == <span style="color: #e45649;">this</span>.id;
      }

</pre>
</div></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
